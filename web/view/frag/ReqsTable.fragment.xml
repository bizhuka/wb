<core:FragmentDefinition
        xmlns="sap.m"
        xmlns:core="sap.ui.core">
    <Table updateStarted="onUpdateStartedReqs" growing="true" growingScrollToLoad="true"
           noDataText="Нет данных" items="{
					                            path: 'wb>/VReqHeaders',
					                            sorter : { path:'Gstrp',
                                                           descending:true
                                                }
					                        }"
           width="auto" enableBusyIndicator="true" mode="{ui>/selectMode}" selectionChange="onReqListSelectionChange">

        <headerToolbar>
            <OverflowToolbar visible="{= ${ui>/showStatus} === true || ${ui>/showSortGroup} === true }">

                <ComboBox selectionChange="onComboSelectionChange" visible="{ui>/showStatus}"
                          items="{ui>/statuses}" width="10rem">
                    <core:Item key="{ui>key}" text="{ui>text}"/>
                </ComboBox>

                <SearchField search="onTextSearch" visible="{ui>/showSortGroup}"
                             placeholder="Поиск заявки" showRefreshButton="false" width="10rem"/>

                <Button browserEvent="onBrowserEvent" press="onSortPress" visible="{ui>/showSortGroup}"
                        icon="sap-icon://sort"/>
                <Button browserEvent="onBrowserEvent" press="onGroupPress" visible="{ui>/showSortGroup}"
                        icon="sap-icon://group-2"/>
            </OverflowToolbar>
        </headerToolbar>

        <columns>
            <Column demandPopin="true" hAlign="Left">
                <header>
                    <Label text="№Операции / №Заказа"/>
                </header>
            </Column>
            <Column demandPopin="true" hAlign="Left" visible="{ui>/showWbColumn}">
                <header>
                    <Label text="Пл/ Статус"/>
                </header>
            </Column>
            <Column demandPopin="true" hAlign="Left" visible="{ui>/showReason}">
                <header>
                    <Label text="Закрытие заявки"/>
                </header>
            </Column>
            <Column demandPopin="true" hAlign="Left">
                <header>
                    <Label text="Дата и время план"/>
                </header>
            </Column>
            <Column demandPopin="true" hAlign="Left" visible="{ui>/showActual}">
                <header>
                    <Label text="Факт. дата / моточасы"/>
                </header>
            </Column>
            <Column demandPopin="true" hAlign="Left" minScreenWidth="Tablet" popinDisplay="WithoutHeader"
                    visible="{ui>/showOptColumn}">
                <header>
                    <Label text="Группа планирования / Тех место"/>
                </header>
            </Column>
            <Column demandPopin="true" hAlign="Left" minScreenWidth="Tablet" popinDisplay="WithoutHeader">
                <header>
                    <Label text="Текст операции / Вид работ"/>
                </header>
            </Column>
            <Column demandPopin="true" hAlign="Left" minScreenWidth="Tablet" popinDisplay="WithoutHeader"
                    visible="{ui>/showOptColumn}">
                <header>
                    <Label text="Класс / Место"/>
                </header>
            </Column>
        </columns>
        <ColumnListItem vAlign="Middle">
            <cells>
                <ObjectStatus title="{ path: 'wb>Aufnr', formatter: '.owner.alphaOut'}"
                              text="&#xA;{ path: 'wb>Objnr', formatter: '.getOutObjnr'}"
                              state="{
                                    path: 'wb>Priok',
                                    formatter: '.getPriority'
                                }"
                              icon="{
                                    path: 'wb>Priok',
                                    formatter: '.getPriorityIcon'
                                }"
                              tooltip="{wb>Priokx}"
                />
                <ObjectIdentifier title="{ path: 'wb>Waybill_Id', formatter: '.waybillOut'}"
                                  titleActive="{= ${userInfo>/WbShowOne}===true}"
                                  titlePress="onWaybillPress"
                                  text="{ parts:[ { path: 'wb>Status' }, { path: 'wb>Waybill_Id' } ], formatter: '.getStatusText' }"
                                  visible="{ui>/showWbColumn}"/>

                <ObjectIdentifier title="{ path: 'wb>StatusReason', formatter: '.getStatusReasonText'}"
                                  titleActive="{= ${userInfo>/WbCloseReqs}===true}"
                                  titlePress="onStatusReasonPress"
                                  text="{wb>Reason}"/>

                <ObjectStatus
                        title="{ path: 'wb>Gstrp', formatter: '.owner.toLocaleDate'  } - { path: 'wb>Gltrp', formatter: '.owner.toLocaleDate' }"
                        text="{= ${wb>Duration}==='0'?'':' ('+${wb>Duration}+')'}"/>

                <ObjectStatus
                        title="{ path: 'wb>FromDate', formatter: '.owner.toLocaleDateTime' } - { path: 'wb>ToDate', formatter: '.owner.toLocaleDateTime' }"
                        text="&#xA;{wb>MotoHour}"
                        visible="{= ${wb>FromDate}!==null}"/>

                <ObjectStatus title="{wb>Innam}" text="&#xA;{wb>Pltxt}" visible="{ui>/showOptColumn}"/>
                <ObjectIdentifier title="{wb>Ltxa1}" text="{wb>Ilatx}"/>
                <ObjectStatus title="{wb>KtschTxt}" text="&#xA;{wb>Stand}" visible="{ui>/showOptColumn}" tooltip="{wb>Ktsch}"/>
            </cells>
        </ColumnListItem>
    </Table>
</core:FragmentDefinition>