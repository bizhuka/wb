<mvc:View controllerName="com.modekzWaybill.controller.Waybill"
          xmlns:core="sap.ui.core"
          xmlns:mvc="sap.ui.core.mvc" xmlns="sap.m">
    <Page title="Путевые листы" showNavButton="true" navButtonPress="onNavBack">
        <!--<headerContent>-->
        <!--	<Button icon="sap-icon://my-sales-order" id="btnOrdersId" press="onOrdersButtonPressed" tooltip="{i18n>home.salesOrder}"/>-->
        <!--	<Button icon="sap-icon://cart" id="btnProductListHeader" press="onShoppingCartPressed" text="{TotalQunatity}"-->
        <!--		tooltip="{i18n>home.cart}"/>-->
        <!--</headerContent>-->
        <content>
            <Table id="id_waybill_table" selectionMode="MultiToggle" rowSelectionChange="onItemPressed"
                   class="sapUiResponsiveMargin"
                   growing="true" growingScrollToLoad="true"
                   noDataText="Нет данных" items="{
					                            path: 'wb>/VWaybills',
					                            sorter : { path:'CreateDate',
                                                           descending:true
                                                }
					                        }"
                   updateStarted="onUpdateStartedTable" width="auto" enableBusyIndicator="true">
                <!--, sorter: {path: 'NUM', descending: false}-->
                <headerToolbar>
                    <OverflowToolbar>
                        <!--<Title text="{catalogTitle}" visible="{= !${device>/system/phone}}"/>-->
                        <!--<ToolbarSpacer visible="{= !${device>/system/phone}}"/>-->
                        <ComboBox id="id_wb_status_combo" selectionChange="handleSelection"
                                  items="{path: '/'}">
                            <core:Item key="{key}" text="{text}"/>
                        </ComboBox>
                        <SearchField id="id_wb_search_field" placeholder="Поиск путевого листа" search="handleSelection"
                                     showRefreshButton="false" width="17.5rem"/>
                        <!--text="{i18n>home.sort}"-->
                        <OverflowToolbarButton icon="sap-icon://sort" press="onSortPressed"
                                               tooltip="Сортировать"/>
                        <OverflowToolbarButton icon="sap-icon://refresh" press="onResetPressed"
                                               tooltip="Очистить всю фильтрацию"/>
                    </OverflowToolbar>
                </headerToolbar>
                <columns>
                    <Column demandPopin="true" hAlign="Left">
                        <header>
                            <Label text="№ путевого листа"/>
                        </header>
                    </Column>
                    <Column demandPopin="true" hAlign="Left">
                        <header>
                            <Label text="Водитель / ТС"/>
                        </header>
                    </Column>
                    <Column demandPopin="true" hAlign="Right">
                        <header>
                            <Label text="Коды"/>
                        </header>
                    </Column>
                    <Column demandPopin="true" hAlign="Right" minScreenWidth="Tablet" popinDisplay="WithoutHeader">
                        <header>
                            <Label text="∑ Заявок / Дней"/>
                        </header>
                    </Column>
                    <Column demandPopin="true" hAlign="Right" minScreenWidth="Tablet" popinDisplay="WithoutHeader">
                        <header>
                            <Label text="∑ Экс заявок / ГСМ"/>
                        </header>
                    </Column>
                    <Column demandPopin="true" hAlign="Right" minScreenWidth="Tablet" popinDisplay="WithoutHeader">
                        <header>
                            <Label text="Статус / Описание"/>
                        </header>
                    </Column>
                </columns>
                <ColumnListItem id="columnListItem" press="onLineItemPressed" type="Navigation" vAlign="Middle"
                                highlight="{ parts:[
                                    { path: 'wb>Status' },
                                    { path: 'wb>Req_Cnt' },
                                    { path: 'wb>Sch_Cnt' },
                                    { path: 'wb>Hist_Cnt' },
                                    { path: 'wb>Gas_Cnt' },
                                    { path: 'wb>DelayReason' }
                                ], formatter: '.rowHighlight' }">
                    <cells>
                        <ObjectIdentifier title="{wb>Id} - ({wb>Werks})" tooltip="{ parts:[
                                    { path: 'wb>Status' },
                                    { path: 'wb>Req_Cnt' },
                                    { path: 'wb>Sch_Cnt' },
                                    { path: 'wb>Hist_Cnt' },
                                    { path: 'wb>Gas_Cnt' },
                                    { path: 'wb>DelayReason' }
                                ], formatter: '.errorDesc' }"/>
                        <ObjectIdentifier title="{wb>Fio}" text="{wb>Eqktx}"
                                          tooltip="Единица оборудования { path: 'wb>Equnr', formatter: '.alphaOut' }"/>
                        <ObjectIdentifier title="{ path: 'wb>Driver', formatter: '.alphaOut' }"
                                          text="{wb>License_num}"/>
                        <ObjectIdentifier title="{wb>Req_Cnt}" text="{wb>Sch_Cnt}"/>
                        <ObjectIdentifier title="{wb>Hist_Cnt}" text="{wb>Gas_Cnt}"/>
                        <ObjectIdentifier
                                title="{ parts:[ { path: 'wb>Status' }, { path: 'wb>Id' } ], formatter: '.getStatusText' }"
                                text="{wb>Description}"/>
                    </cells>
                </ColumnListItem>
            </Table>
        </content>
        <footer>
            <Bar/>
        </footer>
    </Page>
</mvc:View>